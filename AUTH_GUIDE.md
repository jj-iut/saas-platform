# Руководство по аутентификации и ролям

## Роли пользователей

Система поддерживает три роли:
- **user** - обычный пользователь (по умолчанию при регистрации)
- **admin** - администратор
- **superadmin** - суперадминистратор (имеет доступ к управлению ресторанами)

## Создание суперадминистратора

**При первом запуске приложения автоматически создается суперадминистратор.**

Подробности см. в файле [SUPERADMIN_CREDENTIALS.md](./SUPERADMIN_CREDENTIALS.md)

**Быстрый доступ:**
- Email: `admin@saas-platform.com`
- Пароль: `Admin123!`

Если вы хотите создать дополнительного суперадмина, это можно сделать через SQL:

```sql
-- Сначала зарегистрируйте пользователя через API /api/v1/auth/register
-- Затем обновите роль в базе данных:

UPDATE users 
SET role = 'superadmin' 
WHERE email = 'your-email@example.com';
```

Или создайте пользователя напрямую в базе данных (нужен bcrypt хеш пароля).

## API Endpoints

### Публичные endpoints

- `POST /api/v1/auth/register` - Регистрация
- `POST /api/v1/auth/login` - Вход
- `POST /api/v1/auth/refresh` - Обновление токена

### Защищенные endpoints (требуют JWT токен)

- `GET /api/v1/me` - Получить информацию о текущем пользователе

### Только для суперадмина

- `GET /api/v1/restaurants` - Список ресторанов
- `GET /api/v1/restaurants/:id` - Получить ресторан
- `POST /api/v1/restaurants` - Создать ресторан
- `PUT /api/v1/restaurants/:id` - Обновить ресторан
- `DELETE /api/v1/restaurants/:id` - Удалить ресторан

## Использование JWT токенов

После успешного логина или регистрации, клиент получает:
- `access_token` - для доступа к защищенным endpoints (короткий срок жизни)
- `refresh_token` - для обновления access token (длинный срок жизни)

Все защищенные запросы должны включать заголовок:
```
Authorization: Bearer <access_token>
```

## Frontend навигация

После входа пользователь перенаправляется на `/dashboard`.

- Обычные пользователи видят базовую информацию
- Суперадмины видят дополнительную ссылку "Restaurants" для управления ресторанами

## Безопасность

- Пароли хранятся с использованием bcrypt
- JWT токены подписываются секретным ключом
- Доступ к ресторанам ограничен только суперадминистраторами
- CORS настроен для работы с frontend

